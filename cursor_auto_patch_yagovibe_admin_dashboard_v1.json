{
  "project": "YAGO VIBE - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ìë™ ìƒì„± v1.0",
  "description": "ì‹¤ì‹œê°„ ì±„íŒ… í†µê³„ + AI ë¶„ì„ + í‚¤ì›Œë“œ ì‹œê°í™” ê´€ë¦¬ì í˜ì´ì§€",
  "author": "YAGO VIBE Team",
  "created": "2025-01-13",
  "target": "ê´€ë¦¬ììš© í”„ë¡ íŠ¸ì—”ë“œ ì‹œê°í™” ë ˆì´ì–´ ì¶”ê°€ (ë°±ì—”ë“œ ìœ ì§€)",
  "steps": [
    {
      "step": 1,
      "action": "create",
      "file": "src/pages/AdminChatDashboard.tsx",
      "description": "âœ… ê´€ë¦¬ì ë©”ì¸ ëŒ€ì‹œë³´ë“œ - í†µê³„/ê·¸ë˜í”„/ë¡œê·¸",
      "content": "import { useEffect, useState } from 'react';\nimport { collection, getDocs, query, orderBy, limit, where } from 'firebase/firestore';\nimport { db } from '../lib/firebase';\nimport { MessageCircle, TrendingUp, Users, Activity } from 'lucide-react';\nimport ReportCard from '../components/ReportCard';\nimport KeywordChart from '../components/KeywordChart';\nimport ChatTrendChart from '../components/ChatTrendChart';\nimport RecentChatLog from '../components/RecentChatLog';\n\nexport default function AdminChatDashboard() {\n  const [stats, setStats] = useState({ totalMessages: 0, totalRooms: 0, activeUsers: 0, todayMessages: 0 });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchStats = async () => {\n      try {\n        // ì „ì²´ ë©”ì‹œì§€ ìˆ˜ (chatEvents ì»¬ë ‰ì…˜)\n        const eventsSnap = await getDocs(collection(db, 'chatEvents'));\n        const totalMessages = eventsSnap.size;\n\n        // ì „ì²´ ì±„íŒ…ë°© ìˆ˜\n        const roomsSnap = await getDocs(collection(db, 'chatRooms'));\n        const totalRooms = roomsSnap.size;\n\n        // í™œì„± ì‚¬ìš©ì ìˆ˜ (participants ë°°ì—´ì—ì„œ unique)\n        const participants = new Set();\n        roomsSnap.forEach((doc) => {\n          const data = doc.data();\n          data.participants?.forEach((uid) => participants.add(uid));\n        });\n        const activeUsers = participants.size;\n\n        // ì˜¤ëŠ˜ ë©”ì‹œì§€ ìˆ˜\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const todayQuery = query(collection(db, 'chatEvents'), where('createdAt', '>=', today));\n        const todaySnap = await getDocs(todayQuery);\n        const todayMessages = todaySnap.size;\n\n        setStats({ totalMessages, totalRooms, activeUsers, todayMessages });\n      } catch (error) {\n        console.error('í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchStats();\n  }, []);\n\n  if (loading) {\n    return (\n      <div className='min-h-screen bg-gray-50 flex items-center justify-center'>\n        <div className='text-center'>\n          <div className='animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4'></div>\n          <p className='text-gray-500'>ëŒ€ì‹œë³´ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className='min-h-screen bg-gray-50'>\n      {/* í—¤ë” */}\n      <header className='bg-white shadow-sm border-b'>\n        <div className='max-w-7xl mx-auto px-4 py-6'>\n          <h1 className='text-2xl font-bold text-gray-800 flex items-center gap-3'>\n            <Activity className='w-8 h-8 text-blue-500' />\n            âš½ YAGO VIBE ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ\n          </h1>\n          <p className='text-sm text-gray-500 mt-1'>ì‹¤ì‹œê°„ ì±„íŒ… í†µê³„ ë° AI ë¶„ì„</p>\n        </div>\n      </header>\n\n      {/* ë©”ì¸ ì½˜í…ì¸  */}\n      <main className='max-w-7xl mx-auto px-4 py-8'>\n        {/* KPI ì¹´ë“œ 4ê°œ */}\n        <div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8'>\n          <ReportCard title='ì˜¤ëŠ˜ ë©”ì‹œì§€' value={stats.todayMessages} icon={<MessageCircle className='w-6 h-6' />} color='blue' change='+12%' />\n          <ReportCard title='ì „ì²´ ë©”ì‹œì§€' value={stats.totalMessages} icon={<TrendingUp className='w-6 h-6' />} color='green' />\n          <ReportCard title='í™œì„± ì±„íŒ…ë°©' value={stats.totalRooms} icon={<MessageCircle className='w-6 h-6' />} color='purple' />\n          <ReportCard title='í™œì„± ì‚¬ìš©ì' value={stats.activeUsers} icon={<Users className='w-6 h-6' />} color='orange' />\n        </div>\n\n        {/* ì°¨íŠ¸ 2ê°œ */}\n        <div className='grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8'>\n          <div className='bg-white rounded-2xl shadow-md p-6'>\n            <h2 className='text-lg font-semibold text-gray-800 mb-4'>ğŸ“Š ì¼ìë³„ ëŒ€í™”ëŸ‰ ì¶”ì´</h2>\n            <ChatTrendChart />\n          </div>\n          <div className='bg-white rounded-2xl shadow-md p-6'>\n            <h2 className='text-lg font-semibold text-gray-800 mb-4'>ğŸ”¥ ì£¼ìš” í‚¤ì›Œë“œ ë¶„ì„</h2>\n            <KeywordChart />\n          </div>\n        </div>\n\n        {/* ìµœê·¼ ì±„íŒ… ë¡œê·¸ */}\n        <div className='bg-white rounded-2xl shadow-md p-6'>\n          <h2 className='text-lg font-semibold text-gray-800 mb-4'>ğŸ“‹ ìµœê·¼ AI ìš”ì•½ ë¡œê·¸</h2>\n          <RecentChatLog />\n        </div>\n      </main>\n    </div>\n  );\n}"
    },
    {
      "step": 2,
      "action": "create",
      "file": "src/components/ReportCard.tsx",
      "description": "âœ… KPI ì¹´ë“œ ì»´í¬ë„ŒíŠ¸",
      "content": "import React from 'react';\n\ntype ReportCardProps = {\n  title: string;\n  value: number;\n  icon: React.ReactNode;\n  color: 'blue' | 'green' | 'purple' | 'orange';\n  change?: string;\n};\n\nconst colorClasses = {\n  blue: 'bg-blue-50 text-blue-600',\n  green: 'bg-green-50 text-green-600',\n  purple: 'bg-purple-50 text-purple-600',\n  orange: 'bg-orange-50 text-orange-600',\n};\n\nexport default function ReportCard({ title, value, icon, color, change }: ReportCardProps) {\n  return (\n    <div className='bg-white rounded-2xl shadow-md p-6 hover:shadow-lg transition-shadow'>\n      <div className='flex items-center justify-between mb-4'>\n        <div className={`p-3 rounded-xl ${colorClasses[color]}`}>\n          {icon}\n        </div>\n        {change && (\n          <span className='text-sm font-semibold text-green-600'>{change}</span>\n        )}\n      </div>\n      <h3 className='text-sm font-medium text-gray-600 mb-1'>{title}</h3>\n      <p className='text-3xl font-bold text-gray-900'>{value.toLocaleString()}</p>\n    </div>\n  );\n}"
    },
    {
      "step": 3,
      "action": "create",
      "file": "src/components/KeywordChart.tsx",
      "description": "âœ… í‚¤ì›Œë“œ íŒŒì´ ì°¨íŠ¸ (Recharts)",
      "content": "import { useEffect, useState } from 'react';\nimport { PieChart, Pie, Cell, ResponsiveContainer, Legend, Tooltip } from 'recharts';\nimport { collection, getDocs } from 'firebase/firestore';\nimport { db } from '../lib/firebase';\n\nconst COLORS = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6'];\n\nexport default function KeywordChart() {\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchKeywords = async () => {\n      try {\n        // chatEvents ë˜ëŠ” logs ì»¬ë ‰ì…˜ì—ì„œ í‚¤ì›Œë“œ ì§‘ê³„\n        const eventsSnap = await getDocs(collection(db, 'chatEvents'));\n        const keywords = {};\n        \n        eventsSnap.forEach((doc) => {\n          const text = doc.data().text || '';\n          // ê°„ë‹¨í•œ í‚¤ì›Œë“œ ì¶”ì¶œ (ì‹¤ì œë¡œëŠ” AI ìš”ì•½ ê²°ê³¼ ì‚¬ìš©)\n          ['ì§ê±°ë˜', 'ê°€ê²©', 'ë°°ì†¡', 'ìƒí’ˆìƒíƒœ', 'ë¬¸ì˜'].forEach((keyword) => {\n            if (text.includes(keyword)) {\n              keywords[keyword] = (keywords[keyword] || 0) + 1;\n            }\n          });\n        });\n\n        const chartData = Object.entries(keywords)\n          .map(([name, value]) => ({ name, value }))\n          .sort((a, b) => b.value - a.value)\n          .slice(0, 5);\n\n        setData(chartData);\n      } catch (error) {\n        console.error('í‚¤ì›Œë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchKeywords();\n  }, []);\n\n  if (loading) return <div className='text-center py-8'><div className='animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto'></div></div>;\n  if (data.length === 0) return <div className='text-center py-8 text-gray-500'>í‚¤ì›Œë“œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</div>;\n\n  return (\n    <ResponsiveContainer width='100%' height={300}>\n      <PieChart>\n        <Pie data={data} cx='50%' cy='50%' labelLine={false} label={(entry) => `${entry.name} (${entry.value})`} outerRadius={80} fill='#8884d8' dataKey='value'>\n          {data.map((entry, index) => <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />)}\n        </Pie>\n        <Tooltip />\n        <Legend />\n      </PieChart>\n    </ResponsiveContainer>\n  );\n}"
    },
    {
      "step": 4,
      "action": "create",
      "file": "src/components/ChatTrendChart.tsx",
      "description": "âœ… ì¼ìë³„ ëŒ€í™”ëŸ‰ ë¼ì¸ ì°¨íŠ¸",
      "content": "import { useEffect, useState } from 'react';\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { collection, getDocs, query, orderBy as firestoreOrderBy, limit } from 'firebase/firestore';\nimport { db } from '../lib/firebase';\n\nexport default function ChatTrendChart() {\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchTrend = async () => {\n      try {\n        // ìµœê·¼ 30ì¼ ë°ì´í„° ì§‘ê³„\n        const eventsQuery = query(collection(db, 'chatEvents'), firestoreOrderBy('createdAt', 'desc'), limit(1000));\n        const eventsSnap = await getDocs(eventsQuery);\n        \n        const dailyCounts = {};\n        eventsSnap.forEach((doc) => {\n          const data = doc.data();\n          const date = data.createdAt?.toDate ? data.createdAt.toDate().toISOString().split('T')[0] : new Date().toISOString().split('T')[0];\n          dailyCounts[date] = (dailyCounts[date] || 0) + 1;\n        });\n\n        const chartData = Object.entries(dailyCounts)\n          .map(([date, count]) => ({ date: date.substring(5), count }))\n          .reverse()\n          .slice(-30);\n\n        setData(chartData);\n      } catch (error) {\n        console.error('íŠ¸ë Œë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchTrend();\n  }, []);\n\n  if (loading) return <div className='text-center py-8'><div className='animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto'></div></div>;\n  if (data.length === 0) return <div className='text-center py-8 text-gray-500'>íŠ¸ë Œë“œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</div>;\n\n  return (\n    <ResponsiveContainer width='100%' height={300}>\n      <LineChart data={data}>\n        <CartesianGrid strokeDasharray='3 3' />\n        <XAxis dataKey='date' />\n        <YAxis />\n        <Tooltip />\n        <Legend />\n        <Line type='monotone' dataKey='count' stroke='#3B82F6' strokeWidth={2} name='ë©”ì‹œì§€ ìˆ˜' />\n      </LineChart>\n    </ResponsiveContainer>\n  );\n}"
    },
    {
      "step": 5,
      "action": "create",
      "file": "src/components/RecentChatLog.tsx",
      "description": "âœ… ìµœê·¼ AI ìš”ì•½ ë¡œê·¸ í…Œì´ë¸”",
      "content": "import { useEffect, useState } from 'react';\nimport { collection, getDocs, query, orderBy as firestoreOrderBy, limit } from 'firebase/firestore';\nimport { db } from '../lib/firebase';\nimport { ExternalLink } from 'lucide-react';\n\nexport default function RecentChatLog() {\n  const [logs, setLogs] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchLogs = async () => {\n      try {\n        const logsQuery = query(collection(db, 'chatEvents'), firestoreOrderBy('createdAt', 'desc'), limit(20));\n        const logsSnap = await getDocs(logsQuery);\n        const logsData = logsSnap.docs.map((doc) => ({ id: doc.id, ...doc.data() }));\n        setLogs(logsData);\n      } catch (error) {\n        console.error('ë¡œê·¸ ë¡œë“œ ì‹¤íŒ¨:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchLogs();\n  }, []);\n\n  if (loading) return <div className='text-center py-8'><div className='animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto'></div></div>;\n  if (logs.length === 0) return <div className='text-center py-8 text-gray-500'>ë¡œê·¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</div>;\n\n  return (\n    <div className='overflow-x-auto'>\n      <table className='w-full text-sm text-left'>\n        <thead className='text-xs text-gray-700 uppercase bg-gray-100'>\n          <tr>\n            <th className='px-4 py-3'>ì‹œê°„</th>\n            <th className='px-4 py-3'>ë°©ë²ˆí˜¸</th>\n            <th className='px-4 py-3'>ë³´ë‚¸ì´</th>\n            <th className='px-4 py-3'>ë©”ì‹œì§€ ê¸¸ì´</th>\n            <th className='px-4 py-3'>íƒ€ì…</th>\n            <th className='px-4 py-3'>ë§í¬</th>\n          </tr>\n        </thead>\n        <tbody>\n          {logs.map((log) => (\n            <tr key={log.id} className='bg-white border-b hover:bg-gray-50'>\n              <td className='px-4 py-3 text-gray-600'>{log.createdAt?.toDate ? log.createdAt.toDate().toLocaleString('ko-KR') : '-'}</td>\n              <td className='px-4 py-3 font-mono text-xs text-gray-500'>{log.roomId?.substring(0, 8)}...</td>\n              <td className='px-4 py-3 text-gray-700'>{log.sender?.substring(0, 8)}...</td>\n              <td className='px-4 py-3 text-gray-600'>{log.textLength || 0}ì</td>\n              <td className='px-4 py-3'><span className='px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-700'>{log.type || 'message'}</span></td>\n              <td className='px-4 py-3'><a href={`/chat/${log.roomId}`} className='text-blue-500 hover:text-blue-700'><ExternalLink className='w-4 h-4' /></a></td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}"
    },
    {
      "step": 6,
      "action": "update",
      "file": "src/App.tsx",
      "description": "âœ… ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ë¼ìš°íŠ¸ ì¶”ê°€",
      "content_append": "\n// âœ… ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ë¼ìš°íŠ¸ ì¶”ê°€\nimport AdminChatDashboard from './pages/AdminChatDashboard';\n\n// Routes ì„¹ì…˜ì— ì¶”ê°€:\n<Route path='/admin/chat-dashboard' element={<AdminChatDashboard />} />"
    },
    {
      "step": 7,
      "action": "command",
      "command": "npm install recharts",
      "description": "âœ… Recharts ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜"
    }
  ],
  "dependencies": {
    "recharts": "^2.10.0"
  },
  "routes": [
    {
      "path": "/admin/chat-dashboard",
      "component": "AdminChatDashboard",
      "description": "ê´€ë¦¬ì ì±„íŒ… í†µê³„ ëŒ€ì‹œë³´ë“œ"
    }
  ],
  "firestore_collections": {
    "chatEvents": "ë©”ì‹œì§€ ì´ë²¤íŠ¸ ë¡œê·¸",
    "chatRooms": "ì±„íŒ…ë°© ì •ë³´",
    "logs": "n8n Webhook ë¡œê·¸"
  },
  "features": [
    "âœ… ì‹¤ì‹œê°„ í†µê³„ (ì˜¤ëŠ˜/ì „ì²´ ë©”ì‹œì§€, ì±„íŒ…ë°©, ì‚¬ìš©ì)",
    "âœ… ì¼ìë³„ ëŒ€í™”ëŸ‰ ì¶”ì´ (LineChart)",
    "âœ… ì£¼ìš” í‚¤ì›Œë“œ ë¶„ì„ (PieChart)",
    "âœ… ìµœê·¼ AI ìš”ì•½ ë¡œê·¸ (Table)",
    "âœ… ë°˜ì‘í˜• ë””ìì¸ (ëª¨ë°”ì¼/íƒœë¸”ë¦¿/ë°ìŠ¤í¬íƒ‘)",
    "âœ… Tailwind CSS + Recharts"
  ],
  "manual_steps": {
    "after_auto_patch": [
      "1ï¸âƒ£ npm install recharts ì‹¤í–‰",
      "2ï¸âƒ£ /admin/chat-dashboard ì ‘ì†",
      "3ï¸âƒ£ ì‹¤ì‹œê°„ í†µê³„ í™•ì¸"
    ]
  },
  "completion_message": "ğŸ‰ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ìë™ ìƒì„± ì™„ë£Œ!\n\nâœ… ìƒì„±ëœ íŒŒì¼:\n- AdminChatDashboard.tsx (ë©”ì¸ ëŒ€ì‹œë³´ë“œ)\n- ReportCard.tsx (KPI ì¹´ë“œ)\n- KeywordChart.tsx (í‚¤ì›Œë“œ ë¶„ì„)\n- ChatTrendChart.tsx (íŠ¸ë Œë“œ ì°¨íŠ¸)\n- RecentChatLog.tsx (ë¡œê·¸ í…Œì´ë¸”)\n\nğŸ“‹ ë‹¤ìŒ ë‹¨ê³„:\n1. npm install recharts\n2. /admin/chat-dashboard ì ‘ì†\n3. ì‹¤ì‹œê°„ í†µê³„ í™•ì¸\n\nğŸ“Š ëŒ€ì‹œë³´ë“œ ê¸°ëŠ¥:\n- ì˜¤ëŠ˜/ì „ì²´ ë©”ì‹œì§€ í†µê³„\n- ì¼ìë³„ ëŒ€í™”ëŸ‰ ì¶”ì´\n- ì£¼ìš” í‚¤ì›Œë“œ ë¶„ì„\n- ìµœê·¼ AI ìš”ì•½ ë¡œê·¸"
}

