import { useState } from 'react';
export default function AnalysisPanel({ imageUrl, productId }) { const [data, setData] = useState(null); const [loading, setLoading] = useState(false); const [err, setErr] = useState(null); const run = async (e) => { e.stopPropagation(); }; } // ?�벤??버블�?방�?    e.preventDefault();   // 기본 ?�작 방�?        setLoading(true);     setErr(null);    try {      const res = await fetch('/api/analyze', {        method: 'POST',        headers: { 'Content-Type':'application/json' },        body: JSON.stringify({ imageUrl, productId })      });      if (!res.ok) throw new Error(`HTTP ${res.status}`);      const j = await res.json();      setData(j);    } catch (e: any) {      setErr(e.message);    } finally {      setLoading(false);    }  };  return (    <div className="mt-2 border rounded-lg p-3 bg-white shadow-sm" onClick={(e) => e.stopPropagation()}>      <div className="flex items-center justify-between">        <span className="text-sm font-medium">AI 분석</span>        <button          onClick={run}          disabled={loading}          className="text-xs px-3 py-1 rounded bg-indigo-50 hover:bg-indigo-100 text-indigo-700 disabled:opacity-50"        >          {loading ? '분석 중�? : '분석?�기'}        </button>      </div>      {err && <p className="mt-2 text-xs text-red-600">?�패: {err}</p>}      {data && (        <div className="mt-2 text-sm space-y-1">          <p>카테고리: <b>{data.category}</b></p>          <p>?�태: <b>{labelCond(data.condition)}</b></p>          <p>AI 가�??�안: <b>{fmt(data.priceEstimate.low)} ~ {fmt(data.priceEstimate.high)}??/b></p>          <p>?�품 가?�성: <b>{Math.round(data.authenticityScore*100)}%</b></p>          {!!data.riskFlags.length && (            <p className="text-amber-600">?�️ {data.riskFlags.join(', ')}</p>          )}          {!!data.tags.length && (            <p className="text-gray-500">#{data.tags.join(' #')}</p>          )}        </div>      )}    </div>  );}const labelCond = (c: Analysis['condition']) =>  ({new:'?�상??,good:'??,fair:'�?,poor:'??} as any)[c];const fmt = (n: number) => n.toLocaleString('ko-KR');
