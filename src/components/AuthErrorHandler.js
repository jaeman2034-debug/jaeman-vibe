"use strict";
// src/components/AuthErrorHandler.tsx// Firebase ?�증 ?�류 처리 �??�용???�내 컴포?�트import { useState } from 'react';import {   signInWithEmail,   registerWithEmail,   formatAuthErrorForUser,  logAuthError } from '../features/auth/authService';// ?�람친화?�인 ?�증 ?�류 메시지 매핑const AUTH_MSG: Record<string, string> = {  'auth/user-not-found': '가?�되지 ?��? ?�메?�입?�다.',  'auth/wrong-password': '비�?번호가 ?�바르�? ?�습?�다.',  'auth/invalid-credential': '?�메???�는 비�?번호가 ?�바르�? ?�습?�다.',  'auth/too-many-requests': '?�청??많습?�다. ?�시 ???�시 ?�도?�세??',  'auth/network-request-failed': '?�트?�크 ?�류?�니?? ?�터???�결???�인?�주?�요.',  'auth/invalid-email': '?�바�??�메???�식???�닙?�다.',  'auth/email-already-in-use': '?��? ?�용 중인 ?�메?�입?�다.',  'auth/weak-password': '비�?번호가 ?�무 ?�합?�다. 8???�상?�로 ?�정?�주?�요.',  default: '?�증???�패?�습?�다. ?�시 ???�시 ?�도?�세??',};function humanize(code?: string) {  return (code && AUTH_MSG[code]) || `${AUTH_MSG.default}${code ? ` (${code})` : ''}`;}export default function AuthErrorHandler() {  const [email, setEmail] = useState('');  const [password, setPassword] = useState('');  const [isLogin, setIsLogin] = useState(true);  const [error, setError] = useState<string>('');  const [solution, setSolution] = useState<string>('');  const [severity, setSeverity] = useState<'info' | 'warning' | 'error'>('info');  const [isLoading, setIsLoading] = useState(false);  const [success, setSuccess] = useState<string>('');  const handleSubmit = async (e: React.FormEvent) => {    e.preventDefault();    setIsLoading(true);    setError('');    setSolution('');    setSuccess('');    try {      if (isLogin) {        await signInWithEmail(email, password);        setSuccess('로그?�에 ?�공?�습?�다!');      } else {        await registerWithEmail(email, password);        setSuccess('?�원가?�에 ?�공?�습?�다!');      }    } catch (error) {      console.error('[AUTH] Operation failed:', error);            // ?�세???�류 로깅      logAuthError(isLogin ? 'Email Login' : 'Email Registration', error, {         email,         isLogin,        timestamp: new Date().toISOString()       });      // ?�용??친화???�류 메시지 ?�성      const userError = formatAuthErrorForUser(error);      setError(userError.message);      setSolution(userError.solution);      setSeverity(userError.severity);    } finally {      setIsLoading(false);    }  };  const getErrorStyle = (severity: 'info' | 'warning' | 'error') => {    switch (severity) {      case 'info':        return {           background: '#dbeafe',           color: '#1e40af',           border: '1px solid #93c5fd',          padding: '12px',          borderRadius: '8px',          marginBottom: '16px'        };      case 'warning':        return {           background: '#fef3c7',           color: '#92400e',           border: '1px solid #fbbf24',          padding: '12px',          borderRadius: '8px',          marginBottom: '16px'        };      case 'error':        return {           background: '#fee2e2',           color: '#991b1b',           border: '1px solid #f87171',          padding: '12px',          borderRadius: '8px',          marginBottom: '16px'        };      default:        return {           background: '#f3f4f6',           color: '#374151',           border: '1px solid #d1d5db',          padding: '12px',          borderRadius: '8px',          marginBottom: '16px'        };    }  };  const getSuccessStyle = () => ({    background: '#dcfce7',    color: '#166534',    border: '1px solid #86efac',    padding: '12px',    borderRadius: '8px',    marginBottom: '16px'  });  return (    <div style={{      maxWidth: '400px',      margin: '0 auto',      padding: '20px',      border: '1px solid #e5e7eb',      borderRadius: '12px',      background: '#fff'    }}>      <h2 style={{ textAlign: 'center', marginBottom: '24px', color: '#374151' }}>        {isLogin ? '?�� 로그?? : '?�� ?�원가??}      </h2>      {/* ?�공 메시지 */}      {success && (        <div style={getSuccessStyle()}>          ??{success}        </div>      )}      {/* ?�류 메시지 */}      {error && (        <div style={getErrorStyle(severity)}>          <div style={{ fontWeight: 'bold', marginBottom: '8px' }}>            {severity === 'info' && '?�️ ?�보'}            {severity === 'warning' && '?�️ 주의'}            {severity === 'error' && '???�류'}            {' '}{error}          </div>          {solution && (            <div style={{ fontSize: '14px', opacity: 0.8 }}>              ?�� {solution}            </div>          )}        </div>      )}      <form onSubmit={handleSubmit}>        <div style={{ marginBottom: '16px' }}>          <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>            ?�메??          </label>          <input            type="email"            value={email}            onChange={(e) => setEmail(e.target.value)}            placeholder="user@example.com"            required            style={{              width: '100%',              padding: '12px',              border: '1px solid #d1d5db',              borderRadius: '8px',              fontSize: '16px'            }}          />        </div>        <div style={{ marginBottom: '20px' }}>          <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>            비�?번호          </label>          <input            type="password"            value={password}            onChange={(e) => setPassword(e.target.value)}            placeholder="8???�상 ?�력"            required            minLength={8}            style={{              width: '100%',              padding: '12px',              border: '1px solid #d1d5db',              borderRadius: '8px',              fontSize: '16px'            }}          />        </div>        <button          type="submit"          disabled={isLoading}          style={{            width: '100%',            padding: '14px',            background: isLoading ? '#9ca3af' : '#3b82f6',            color: 'white',            border: 'none',            borderRadius: '8px',            fontSize: '16px',            fontWeight: '600',            cursor: isLoading ? 'not-allowed' : 'pointer',            marginBottom: '16px'          }}        >          {isLoading ? '처리 �?..' : (isLogin ? '로그?? : '?�원가??)}        </button>      </form>      {/* 모드 ?�환 */}      <div style={{ textAlign: 'center' }}>        <button          type="button"          onClick={() => {            setIsLogin(!isLogin);            setError('');            setSolution('');            setSuccess('');          }}          style={{            background: 'none',            border: 'none',            color: '#3b82f6',            cursor: 'pointer',            textDecoration: 'underline',            fontSize: '14px'          }}        >          {isLogin ? '계정???�으?��??? ?�원가?? : '?��? 계정???�으?��??? 로그??}        </button>      </div>      {/* ?�버�??�보 */}      <details style={{ marginTop: '20px', fontSize: '12px', color: '#6b7280' }}>        <summary style={{ cursor: 'pointer' }}>?�� ?�버�??�보</summary>        <div style={{ marginTop: '8px', padding: '8px', background: '#f3f4f6', borderRadius: '4px' }}>          <div>?�메?? {email || '(?�력?��? ?�음)'}</div>          <div>비�?번호 길이: {password?.length || 0}</div>          <div>모드: {isLogin ? '로그?? : '?�원가??}</div>          <div>로딩 ?�태: {isLoading ? '?? : '?�니??}</div>          <div>?�류 ?�태: {error ? '?? : '?�니??}</div>        </div>      </details>    </div>  );} 
