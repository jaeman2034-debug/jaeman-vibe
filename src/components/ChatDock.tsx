import { useEffect, useMemo, useState } from 'react';import { speak, isCurrentlyListening } from '@/lib/tts';type Missing = ('email'|'phone'|'password')[];export default function ChatDock({  missing, pwStatus, onAsk}: { missing: Missing; pwStatus: 'ok'|'weak'|'missing'; onAsk: (text:string)=>void }) {  const nextQ = useMemo(() => {    if (missing.includes('email')) {      return '?´ë©”?¼ì„ ?¤ì‹œ ?œë²ˆ ?ë°•?ë°• ë§í•´ ì£¼ì„¸?? "?„ì´??ê³¨ë±…??ì§€ë©”ì¼ ??ì»? ?•ì‹??ì¢‹ì•„??';    }    if (missing.includes('phone')) {      return '?„í™”ë²ˆí˜¸??010ë¶€???«ìë§??´ì–´??ë§í•´ ì£¼ì„¸?? ?? "ê³µì¼ê³?1234 5678".';    }    if (missing.includes('password') || pwStatus !== 'ok') {      return 'ë¹„ë?ë²ˆí˜¸??"ë¹„ë?ë²ˆí˜¸??..." ?¤ì— ??ê¸€?ì”© ë§ì???ì£¼ì„¸?? ?? "?ì´. ë¹? ?? 1 2 3 4".';    }    return '';  }, [missing, pwStatus]);  useEffect(() => {    if (!nextQ) return;    speak(nextQ); // ??TTS ê°€???¬ìš©    // ?”ë ˆë©”íŠ¸ë¦? chat.ask_missing_field    fetch("/api/telemetry", {      method: "POST",      headers: { "Content-Type": "application/json" },      body: JSON.stringify({ schema:1, events:[{ type:'chat.ask_missing_field', data:{ nextQ } }]})    }).catch(() => {}); // ?¤íŒ¨?´ë„ ??ì§„í–‰ ë°©í•´ ê¸ˆì?  }, [nextQ]);  if (!nextQ) return null;  return (    <div className="fixed bottom-4 right-4 max-w-md rounded-xl border bg-white/85 p-3 shadow">      <div className="font-semibold mb-2">?„ì?ë§?/div>      <div className="text-sm leading-5">{nextQ}</div>      <div className="mt-2 flex gap-2">        <button className="px-3 py-1.5 rounded bg-black text-white"          onClick={()=>onAsk(nextQ)}>?ìŠ¤?¸ë¡œ ë³´ê¸°</button>        <button className="px-3 py-1.5 rounded border"          onClick={()=>speak(nextQ)} // ??TTS ê°€???¬ìš©          disabled={isCurrentlyListening()}>?¤ì‹œ ?£ê¸°</button>      </div>    </div>  );}