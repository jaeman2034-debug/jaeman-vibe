import React from "react";import LocationBadge from "./LocationBadge";import AnalysisPanel from "./AnalysisPanel";export type MarketDGItemData = {  id: string;  title: string;  price?: number;  description?: string;  // ?í’ˆ ?¤ëª… ì¶”ê?  category?: string;  // ì¹´í…Œê³ ë¦¬ ?„ë“œ ì¶”ê?  images?: (string | { url: string; path: string; filename: string; size: number; type: string; uploadedAt: any })[];  // ?”¥ ProductCard?€ ?™ì¼???€??  location?: { lat: number; lng: number; placeName?: string };          // ?„ì¹˜ ?•ë³´ (lat, lng, placeName)  status?: "?ë§¤ì¤? | "?ˆì•½ì¤? | "ê±°ë˜?„ë£Œ";  sellerId?: string;  // ?ë§¤??ID ì¶”ê?  sellerStats?: { trades: number; starsSum: number; pos: number; neg: number }; // ?ë§¤???µê³„ ì¶”ê?  address?: { sido: string; sigungu: string; dong: string; full: string }; // ?‰ì •???•ë³´ ì¶”ê?  // ?”¥ ?ˆë¡œ???„ì¹˜ ë°?ì£¼ì†Œ ?„ë“œ  loc?: { lat: number; lng: number };  addr?: {    bjd?: string;    hjd?: string;    hjdStatus?: 'pending' | 'ok' | 'fail';    hjdSource?: 'kakao' | 'naver';    hjdCheckedAt?: any;  };  chatCount?: number;  likeCount?: number;  viewCount?: number;  createdAt?: Date | number;  // Date | ms  analysis?: any;     // AI ë¶„ì„ ê²°ê³¼ (Analysis ?€?…ìœ¼ë¡??•ì¥ ê°€??  source?: 'products' | 'market';  // ??ì¶œì²˜ êµ¬ë¶„??};function formatPrice(v?: number) {  if (v == null) return "ê°€ê²©ë¬¸??;  if (v <= 0) return "ê°€ê²?ë¯¸ì •";  return v.toLocaleString("ko-KR") + "??;}function timeAgo(input?: Date | number) {  if (!input) return "";  const d = typeof input === "number" ? new Date(input) : input;  const diff = (Date.now() - d.getTime()) / 1000;  if (diff < 60) return "ë°©ê¸ˆ??;  if (diff < 3600) return Math.floor(diff / 60) + "ë¶???;  if (diff < 86400) return Math.floor(diff / 3600) + "?œê°„ ??;  return Math.floor(diff / 86400) + "????;}type Props = {   item: MarketDGItemData;   onClick?: (id: string) => void;  userLocation?: { lat: number; lng: number } | null;  // ?¬ìš©???„ì¬ ?„ì¹˜};export default function MarketDGItem({ item, onClick, userLocation }: Props) {  // ì¹´ë“œ?ì„œ ì»¤ë²„ ? íƒ (images[0].url ?°ì„ , ?ˆê±°??imageUrl ë°±ì—…)  const cover = (() => {    const firstImage = item?.images?.[0];    if (firstImage && typeof firstImage === 'object' && 'url' in firstImage) {      return firstImage.url;    }    if (firstImage && typeof firstImage === 'string') {      return firstImage;    }    return null;  })();  const counts = [    item.chatCount ? `ì±„íŒ… ${item.chatCount}` : "",    item.likeCount ? `ê´€??${item.likeCount}` : "",    item.viewCount ? `ì¡°íšŒ ${item.viewCount}` : "",  ].filter(Boolean);  // AI ë¶„ì„ ?„ë£Œ ?¸ë“¤??(?„ìš”???¬ìš©)  const handleAnalysisComplete = (result: any) => {    console.log('AI ë¶„ì„ ?„ë£Œ:', item.id, result);    // TODO: ?ìœ„ ì»´í¬?ŒíŠ¸ë¡?ê²°ê³¼ ?„ë‹¬  };  // AI ë¶„ì„ ?¨ë„ ?´ë¦­ ???´ë²¤??ë²„ë¸”ë§?ë°©ì?  const handleAnalysisClick = (e: React.MouseEvent) => {    e.stopPropagation();  };  return (    <button      className="dgi"      onClick={() => onClick?.(item.id)}      aria-label={item.title}    >      <div className="dgi-img">        {cover ? (          <img src={cover} alt={item.title} />        ) : (          <div className="dgi-empty" />        )}        {item.status && <span className="dgi-badge">{item.status}</span>}      </div>      <div className="dgi-body">        <div className="dgi-title line-2">{item.title}</div>                {/* ?„ì¹˜ ?•ë³´ */}        {item.location && (          <div className="mb-2">            <LocationBadge               my={userLocation || undefined}              item={item.location}            />          </div>        )}                <div className="dgi-meta">          {timeAgo(item.createdAt)}        </div>                <div className="dgi-price">{formatPrice(item.price)}</div>                {/* AI ë¶„ì„ ?¨ë„ - ?´ë¦­ ?´ë²¤??ë²„ë¸”ë§?ë°©ì? */}        {cover && (          <div className="mt-3" onClick={handleAnalysisClick}>            <AnalysisPanel              imageUrl={cover}              productId={item.id}            />          </div>        )}                {counts.length > 0 && (          <div className="dgi-counts">            {counts.map((c, i) => (              <span key={i}>{c}</span>            ))}          </div>        )}      </div>    </button>  );}