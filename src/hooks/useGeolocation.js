import { useState } from 'react';
export default function useGeolocation() { const [coords, setCoords] = useState(null); const [err, setErr] = useState(null); const [permission, setPermission] = useState(null); const [isEnabled, setIsEnabled] = useState(true); } // ?�치 ?�보�?가?�올 ???�정???�보???�께 가?�오�?  const getLocationWithAddress = async (lat: number, lng: number) => {    try {      const address = await reverseGeocodeDong(lat, lng);      return { lat, lng, address };    } catch (error) {      console.warn('?�정???�보�?가?�올 ???�습?�다:', error);      return { lat, lng };    }  };  useEffect(() => {    if (!navigator.geolocation) {      setErr('브라?��?가 ?�치 ?�비?��? 지?�하지 ?�습?�다.');      return;    }    // ?�치 권한 ?�태 ?�인    if (navigator.permissions) {      navigator.permissions.query({ name: 'geolocation' as PermissionName }).then((result) => {        setPermission(result.state);        result.onchange = () => {          setPermission(result.state);          if (result.state === 'denied') {            setCoords(null);            setErr('?�치 권한??거�??�었?�니??');          }        };      });    }    // ?�치 감시 ?�작    let id: number | null = null;        if (isEnabled) {      id = navigator.geolocation.watchPosition(        async (pos) => {          const locationWithAddress = await getLocationWithAddress(pos.coords.latitude, pos.coords.longitude);          setCoords(locationWithAddress);          setErr(null);        },        (e) => {          console.error('[GEOLOCATION] ?�류:', e);          switch (e.code) {            case e.PERMISSION_DENIED:              setErr('?�치 권한??거�??�었?�니?? 브라?��? ?�정?�서 ?�치�??�용?�주?�요.');              setPermission('denied');              break;            case e.POSITION_UNAVAILABLE:              setErr('?�치 ?�보�?가?�올 ???�습?�다.');              break;            case e.TIMEOUT:              setErr('?�치 ?�보 ?�청 ?�간??초과?�었?�니??');              break;            default:              setErr('?�치 ?�보�?가?�오??�??�류가 발생?�습?�다.');          }        },        {           enableHighAccuracy: true,           maximumAge: 10_000,           timeout: 10_000         }      );    }    return () => {      if (id !== null) {        navigator.geolocation.clearWatch(id);      }    };  }, [isEnabled]);  // ?�치 ?�비???��?  const toggleLocation = () => {    setIsEnabled(!isEnabled);    if (!isEnabled) {      setCoords(null);      setErr(null);    }  };  // ?�치 권한 ?�청  const requestPermission = async () => {    if (navigator.geolocation) {      navigator.geolocation.getCurrentPosition(        async (pos) => {          const locationWithAddress = await getLocationWithAddress(pos.coords.latitude, pos.coords.longitude);          setCoords(locationWithAddress);          setErr(null);          setPermission('granted');          setIsEnabled(true);        },        (e) => {          setErr('?�치 권한 ?�청??거�??�었?�니??');          setPermission('denied');        }      );    }  };  return {     coords,     err,     permission,     isEnabled,     toggleLocation,     requestPermission   };}
