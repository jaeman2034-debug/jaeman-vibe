// src/hooks/useSpeechRecognition.tsimport { useEffect, useState, useRef } from 'react';import { startListeningGuard, stopListeningGuard, isCurrentlySpeaking, stripExamples } from '@/lib/tts';export const useSpeechRecognition = () => {  const [transcript, setTranscript] = useState('');  const [isListening, setIsListening] = useState(false);  const recognitionRef = useRef<SpeechRecognition | null>(null);  useEffect(() => {    const SpeechRecognition =      (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;    if (!SpeechRecognition) {      alert('??ë¸Œë¼?°ì????Œì„± ?¸ì‹??ì§€?í•˜ì§€ ?ŠìŠµ?ˆë‹¤.');      return;    }    const recognition = new SpeechRecognition();    recognition.lang = 'ko-KR';    recognition.interimResults = false;  // ì¤‘ê°„ ê²°ê³¼ ë¹„í™œ?±í™”    recognition.continuous = false;      // ?ŒìŠ¤?????ˆì •??    recognition.onresult = (event: SpeechRecognitionEvent) => {      // ?¹ì‹œ?¼ë„ TTSê°€ ì¼œì ¸?ˆìœ¼ë©?ê²°ê³¼ ë¬´ì‹œ      if (isCurrentlySpeaking()) return;            const rawResult = event.results[0][0].transcript;      // ?„ì?ë§??ˆì‹œ ë¬¸ìž¥ ?œê±° (ë³´ì¡° ?ˆì „ë§?      const cleaned = stripExamples(rawResult);            // ê°œë°œ ?˜ê²½?ì„œë§?ë¡œê·¸ ì¶œë ¥      if (import.meta.env.DEV && rawResult !== cleaned) {        console.log("?” ?ˆì‹œ ë¬¸ìž¥ ?œê±°:", { raw: rawResult, cleaned });      }            setTranscript(cleaned);    };    recognition.onend = () => {      setIsListening(false);      stopListeningGuard(); // ??TTS ?¬ìƒ ?ˆìš©    };    recognitionRef.current = recognition;  }, []);  const startListening = () => {    if (recognitionRef.current) {      setTranscript('');      startListeningGuard(); // ??TTS ì¦‰ì‹œ ì¤‘ë‹¨      recognitionRef.current.interimResults = false;      recognitionRef.current.continuous = false;  // ?ŒìŠ¤?????ˆì •??      recognitionRef.current.start();      setIsListening(true);    }  };  return { transcript, isListening, startListening };};