// src/lib/nlu/ko/extractors.ts// ?œê? ?´ë¦„/?´ë©”??ê°„ì´ ì¶”ì¶œê¸?(ì½˜ì†”?ì„œ???¬ì‚¬??function sanitize(s: string) {    return s      .replace(/(?:^|\s)[??-?“â€?\s+(?=[?œâ€??˜â€?A-Za-zê°€-??)/g, ' ')      .replace(/[??-?“â€?/g, ' ')      .replace(/[?œâ€??˜â€?Â«Â»?Œã€ã€ã€?/g, ' ')      .replace(/[(){}\[\]<>]/g, ' ')      .replace(/[!ï¼?ï¼?/g, '.')      .replace(/\s+/g, ' ')      .trim();  }    function pickHangulName(seg: string) {    seg = seg.replace(/([ê°€-??)\s+(?=[ê°€-??)/g, '$1'); // ????ë§????´ì¬ë§?    const tokens = seg.match(/[ê°€-??{2,6}/g) || [];    tokens.sort((a, b) => b.length - a.length);    return (tokens[0] || '').replace(/??/, '');  }    export function extractName(raw: string) {    const text = sanitize(raw);    const TRIG = /(?:??s*)??´ë¦„\s*(?:?€|??:)?\s*/i;    const STOP = /(?!^)[\n,.\-!???'??\]} ]|?…ë‹ˆ???´ì—???´ë¼ê³??¼ê³ |?¼êµ¬???´ë¼êµ?/i; // ë©ˆì¶¤ ì§€??    const re = new RegExp(TRIG.source + '([\\s\\S]{0,30}?)' + STOP.source, 'i');    const m = text.match(re);    const seg = m ? m[1] : '';    const value = pickHangulName(seg);    return { value, ok: !!value, text, seg };  }    function normalizeEmailTokens(s: string) {    const PROVIDER_KO: Record<string, string> = {      'ì§€ë©”ì¼':'gmail','ì§€ ë©”ì¼':'gmail','gë©”ì¼':'gmail','gmail':'gmail',      '?¤ì´ë²?:'naver','?¤ì´ë²?:'naver','naver':'naver','?¤ìŒ':'daum','?œë©”??:'hanmail',      'ì¹´ì¹´??:'kakao','ì¹´ì¹´?¤ë©”??:'kakao','?¼í›„':'yahoo','?«ë©”??:'hotmail','??ë©”ì¼':'hotmail',      'outlook':'outlook'    };    const TLD_KO: Record<string, string> = {      'ì»?:'com','ì½?:'com','?·ì»´':'com','com':'com','??:'net','org':'org','?¤ì•Œì§€':'org','?¤ì???:'org',      'ì¼€?´ì•Œ':'kr','kr':'kr','ì½?:'co','?¨ì˜¤':'co'    };      s = s      .replace(/ê³?s*ë±?s*??ê³¨ë±…????at/gi, ' @ ')      .replace(/?????„íŠ¸|dot/gi, ' . ')      .replace(/(??s*ë©?s*(?:?????\s*(?:????ë¥?ë¯?|??s*ë©??´ë©œ|ë©?s*??ë©”ì¼)/gi, ' ?´ë©”??')      .replace(/?´ë©”??ë©”ì¼|ì£¼ì†Œ|?€|???…ë‹ˆ???´ì—??ë§í• ê²??¤ì‹œ/gi, ' ');      for (const [k, v] of Object.entries(PROVIDER_KO)) s = s.replace(new RegExp(k, 'gi'), ' ' + v + ' ');    for (const [k, v] of Object.entries(TLD_KO)) s = s.replace(new RegExp(k, 'gi'), ' ' + v + ' ');      return s.replace(/\s+/g, ' ').trim();  }    export function extractEmail(raw: string) {    const STOP = /(?„í™”|ë²ˆí˜¸|ë¹„ë?ë²ˆí˜¸|ë¹„ë²ˆ|?´ë¦„|???…ë‹ˆ???´ì—???¤ì‹œ ë§??¬ì§ˆë¬?/i;    const TRIG = '(?:??\s*ë©?\s*(?:?????\\s*(?:????ë¥?ë¯?|??\s*ë©??´ë©œ|ë©?\s*??ë©”ì¼)\\s*(?:?€|????:)?\\s*';    const re = new RegExp(TRIG + '([\\s\\S]{0,120}?)(?=' + STOP.source + '|$)', 'i');    const m = raw.match(re);    const seg = m?.[1] ?? raw;      const s = normalizeEmailTokens(seg);    const em = s.match(/([A-Za-z0-9._\-\s]+)\s*@\s*([A-Za-z0-9\-]+)\s*\.\s*([A-Za-z]{2,})/);    if (!em) return { value: '', ok: false, s };    const id = em[1].replace(/[\s.]/g, '').toLowerCase();    return { value: `${id}@${em[2].toLowerCase()}.${em[3].toLowerCase()}`, ok: true, s };  }  
