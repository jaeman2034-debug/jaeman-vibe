"use strict";
// src/lib/parse-ko-email.tsexport type ExtractEmailResult = {    value: string;   // ?�규?�된 email (?�공 ??    ok: boolean;     // ?�싱 ?�공 ?��?    seg?: string;    // ?�아??구간 (?�버그용)    s?: string;      // ?�규??중간 문자??(?�버그용)  };    const PROVIDER_KO: Record<string, string> = {    '지메일': 'gmail', '지 메일': 'gmail', 'g메일': 'gmail', 'gmail': 'gmail',    '?�이�?: 'naver', '?�이�?: 'naver', 'naver': 'naver',    '?�음': 'daum', '?�메??: 'hanmail', 'daum': 'daum', 'hanmail': 'hanmail',    '카카??: 'kakao', '카카?�메??: 'kakao', 'kakao': 'kakao',    '?�후': 'yahoo', 'yahoo': 'yahoo',    '?�메??: 'hotmail', '??메일': 'hotmail', 'hotmail': 'hotmail',    '?�웃�?: 'outlook', 'outlook': 'outlook',  };    const TLD_KO: Record<string, string> = {    '?�컴': 'com', '�?: 'com', '�?: 'com', 'com': 'com',    '??: 'net', 'net': 'net',    '?�알지': 'org', '?��???: 'org', 'org': 'org',    '케?�알': 'kr', 'kr': 'kr',    '�?: 'co', '?�오': 'co', 'co': 'co',  };    /** ?�국??발화 ?�규?? ?�골뱅이/??지메일/?�컴 ?��???"@", ".", "gmail", "com" */  function normalizeUtterance(s: string): string {    s = s      .replace(/�?s*�?s*????at/gi, ' @ ')      .replace(/?????�트|dot/gi, ' . ')      // 메일 관???�단???�거      .replace(        /(??s*�?s*(?:?????\s*(?:????�?�?|??s*�??�멜|�?s*??메일|?�메??메일|주소|?�|?????�니???�에???�요|말할�??�시|?�번|그리�?그런??/gi,        ' ',      );      for (const [k, v] of Object.entries(PROVIDER_KO)) {      s = s.replace(new RegExp(k, 'gi'), ` ${v} `);    }    for (const [k, v] of Object.entries(TLD_KO)) {      s = s.replace(new RegExp(k, 'gi'), ` ${v} `);    }      return s.replace(/\s+/g, ' ').trim();  }    /** ?�메?????�어�?뽑기 */  export function extractEmail(raw: string): ExtractEmailResult {    // ?�이메일?�/메일?�/?�멜?� ??(?�기부?????�리�?    const TRIG =      /(?:??s*�?s*(?:?????\s*(?:????�?�?|??s*�??�멜|�?s*??메일)\s*(?:?�|????:)?\s*/i;      // ?�기 ?�오�??�메???�명 ??    const STOP =      /(?�화|번호|비�?번호|비번|?�름|???�니???�에???�요|?�시 �??�질�?질문|주소 ??/i;      const m = raw.match(      new RegExp(TRIG.source + '([\\s\\S]{0,120}?)(?=' + STOP.source + '|$)', 'i'),    );    const seg = m?.[1] ?? raw; // ?�리거�? ?�으�??�째�??�도    const s = normalizeUtterance(seg);      // id @ provider . tld  (id 부분�? 공백/???�용 ??최종 ?�규?�에???�거)    const em = s.match(/([A-Za-z0-9._\- ]+)\s*@\s*([A-Za-z0-9\-]+)\s*\.\s*([A-Za-z]{2,6})/);    if (!em) return { value: '', ok: false, seg, s };      const id = em[1].replace(/[\s.]/g, '').toLowerCase(); // ?�jae. man 2034?????�jaeman2034??    const host = em[2].toLowerCase();    const tld = em[3].toLowerCase();      return { value: `${id}@${host}.${tld}`, ok: true, seg, s };  }  
