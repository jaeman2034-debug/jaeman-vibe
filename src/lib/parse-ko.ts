export function normalizeEmail(raw: string) {  const koNum: Record<string,string> = { ê³?"0",??"0",??"1",??"2",??"3",??"4",??"5",??"6",ì¹?"7",??"8",êµ?"9" };  const m = raw.match(/([A-Za-z0-9._%+\- ]+)\s*([ê³µì˜?¼ì´?¼ì‚¬?¤ìœ¡ì¹ íŒ”êµ?)?\s*@\s*([A-Za-z0-9.\-]+)\s*\.\s*([A-Za-z]{2,})/i);  if (!m) return null;  const local = m[1].replace(/[ \.]/g, "").toLowerCase();  const hangul = m[2] ? (koNum[m[2]] ?? "") : "";  const domain = (m[3] + "." + m[4]).replace(/\s+/g, "").toLowerCase();  const local2 = /\d$/.test(local) ? local + hangul : local;  return `${local2}@${domain}`;}export function extractPhone(raw: string) {  const rep = (s: string) => s    .replace(/ê³???g,"0").replace(/??g,"1").replace(/??g,"2").replace(/??g,"3").replace(/??g,"4")    .replace(/??g,"5").replace(/??g,"6").replace(/ì¹?g,"7").replace(/??g,"8").replace(/êµ?g,"9")    .replace(/[^\d]/g,"");  const digits = rep(raw);  const m = digits.match(/01[016789]\d{7,8}/);  if (!m) return null;  const d = m[0];  const display = d.length === 10 ? `${d.slice(0,3)}-${d.slice(3,6)}-${d.slice(6)}`                                   : `${d.slice(0,3)}-${d.slice(3,7)}-${d.slice(7)}`;  return { display, digits: d };}export type PwStatus = "ok" | "weak" | "missing";/** ?œê?ë¡?ë§í•œ ?ŒíŒŒë²??«ì/êµ¬ë‘???•ê·œ???¬ì „ */const KO_LETTER: Record<string, string> = {  ?ì´:"A", ë¹?"B", ??"C", ??"D", ??"E", ?í”„:"F", ì§€:"G", ?ì´ì¹?"H", ?ì·¨:"H",  ?„ì´:"I", ?œì´:"J", ì¼€??"K", ??"L", ??"M", ??"N", ??"O", ??"P", ??"Q",  ??"R", ?ìŠ¤:"S", ??"T", ??"U", ë¸Œì´:"V", ?”ë¸”??"W", ?‘ìŠ¤:"X", ?€??"Y", ì§€??"Z"};const KO_NUM: Record<string,string> = { ê³?"0", ??"0", ??"1", ??"2", ??"3", ??"4", ??"5", ??"6", ì¹?"7", ??"8", êµ?"9" };/** ?„í–‰ ë¬¸ì¥(?´ë©”???„í™”/?´ë¦„/?ë§º?? ?ì—??ë©ˆì¶”?„ë¡ ê²½ê³„ ì§€??*/const PASSWORD_STOP_RE = /(?´ë©”??ë©”ì¼|?„í™”|ë²ˆí˜¸|?´ë¦„|ì£¼ì†Œ|???…ë‹ˆ???´ì—???¤ì‹œ ë§??¬ì§ˆë¬??¬ì„¤??/i;// ???¸ë¦¬ê±°ë? 'ë¹„ìº¡ì²?ê·¸ë£¹'?¼ë¡œ ?•ì˜??ìº¡ì²˜ ?¸ë±???¼ì„  ?œê±°const TRIGGER = '(?:ë¹?\s*ë°€\\s*ë²?\s*??ë¹?\s*ë²??”í˜¸|password)(?:\\s*(?:?€|??:))?\\s*';export function extractPassword(raw: string): { value: string; status: PwStatus } {  // ?¸ë¦¬ê±???ìµœë? 100?ë? ìº¡ì²˜, ?¤ìŒ ??ª©(PASSWORD_STOP_RE) ?ì—??ë©ˆì¶¤  const re = new RegExp(TRIGGER + '([\\s\\S]{0,100}?)(?=' + PASSWORD_STOP_RE.source + '|$)', 'i');  let s = "";  const m = raw.match(re);  if (m && m[1]) s = m[1];  else {    // ?´ë°±: ?¸ë¦¬ê±??„ì¹˜ë¶€???ê¹Œì§€    const idx = raw.search(new RegExp(TRIGGER, 'i'));    if (idx >= 0) s = raw.slice(idx);  }  // ?œêµ­???ŒíŒŒë²??«ì ì¹˜í™˜  s = s.replace(new RegExp(Object.keys(KO_LETTER).join("|"), "g"), w => KO_LETTER[w]);  s = s.replace(new RegExp(Object.keys(KO_NUM).join("|"), "g"), w => KO_NUM[w]);  // ?¡ë‹¨??êµ¬ë‘???•ë¦¬  s = s.replace(/?¤ì‹œ ë§í• ê²?ëª??Œì•„???…ë‹ˆ????./g, " ");  s = s.replace(/[Â·?â€¢âˆ™?§ãƒ»]/g, ".").replace(/\s+/g, " ").replace(/\./g, " ");  // ? í° ë³‘í•© ??ê¸¸ì´ ?ì •  const tokens = s.match(/[A-Za-z0-9!@#$%^&*_\-+=]+/g) || [];  const joined = tokens.join("");  if (joined.length >= 8) return { value: joined, status: "ok" };  if (joined.length >= 6) return { value: joined, status: "weak" };  return { value: "", status: "missing" };}// ?´ë©”???Œì„œ ë³´ê°•const PROVIDER_KO: Record<string, string> = {  'ì§€ë©”ì¼':'gmail','ì§€ ë©”ì¼':'gmail','gë©”ì¼':'gmail','gmail':'gmail',  '?¤ì´ë²?:'naver','?¤ì´ë²?:'naver','naver':'naver',  '?¤ìŒ':'daum','?œë©”??:'hanmail','ì¹´ì¹´??:'kakao','ì¹´ì¹´?¤ë©”??:'kakao',  '?¼í›„':'yahoo','?«ë©”??:'hotmail','??ë©”ì¼':'hotmail','outlook':'outlook'};const TLD_KO: Record<string, string> = {  'ì»?:'com','ì½?:'com','?·ì»´':'com','com':'com',  '??:'net','org':'org','?¤ì•Œì§€':'org','?¤ì???:'org',  'ì¼€?´ì•Œ':'kr','kr':'kr','ì½?:'co','?¨ì˜¤':'co'};// ?ì£¼ ?˜ì˜¤???¤í?/ë³€???•ê·œ??function normalizeEmailTokens(s: string) {  // 'ê³¨ë±…??at' ??'@', '????dot' ??'.'  s = s    .replace(/ê³?s*ë±?s*????at/gi, ' @ ')    .replace(/?????„íŠ¸|dot/gi, ' . ');  // '?´ë©”?? ?¤í?/ë³€?•ì„ ?˜ë‚˜ë¡??µì¼ (?´ë©”ë¯??´ë©œ/ë©?????  s = s.replace(    /(??s*ë©?s*(?:?????\s*(?:????ë¥?ë¯?|??s*ë©??´ë©œ|ë©?s*??ë©”ì¼)/gi,    ' ?´ë©”??'  );  // ?œê? provider/tld ??ascii  for (const [k, v] of Object.entries(PROVIDER_KO)) {    s = s.replace(new RegExp(k, 'gi'), ` ${v} `);  }  for (const [k, v] of Object.entries(TLD_KO)) {    s = s.replace(new RegExp(k, 'gi'), ` ${v} `);  }  // êµ°ë”?”ê¸° ?œê±°  s = s.replace(/?´ë©”??ë©”ì¼|ì£¼ì†Œ|?€|???…ë‹ˆ???´ì—??ë§í• ê²??¤ì‹œ|??./gi, ' ');  return s.replace(/\s+/g, ' ').trim();}// ?´ë©”???¸ë¦¬ê±? '?´ë©”???¤í?' ?´í›„ ~ STOP ?¤ì›Œ???„ê¹Œì§€const EMAIL_TRIGGER = '(?:??\s*ë©?\s*(?:?????\\s*(?:????ë¥?ë¯?|??\s*ë©??´ë©œ|ë©?\s*??ë©”ì¼)\\s*(?:?€|????:)?\\s*';const STOP_RE = /(?„í™”|ë²ˆí˜¸|ë¹„ë?ë²ˆí˜¸|ë¹„ë²ˆ|?´ë¦„|???…ë‹ˆ???´ì—???¤ì‹œ ë§??¬ì§ˆë¬?/i;function _testEmail(raw: string): { value: string; ok: boolean } {  // ?°ì„  ?¸ë¦¬ê±?êµ¬ê°„???˜ë¼ë³´ê³ , ?¤íŒ¨ ???„ì²´?ì„œ ?¨í„´ ê²€??  const re = new RegExp(EMAIL_TRIGGER + '([\\s\\S]{0,120}?)(?=' + STOP_RE.source + '|$)', 'i');  let seg = '';  const m = raw.match(re);  seg = m?.[1] ? m[1] : raw;  // ?•ê·œ??  let s = normalizeEmailTokens(seg);  // id @ provider . tld  const A = 'A-Za-z0-9';  const emailRe = new RegExp(`([${A}._\\-\\s]+)\\s*@\\s*([${A}\\-]+)\\s*\\.\\s*([A-Za-z]{2,})`);  let mm = s.match(emailRe);  // ?¸ë¦¬ê±?ê¸°ë°˜???¤íŒ¨?˜ë©´ ?ë¬¸ ?„ì²´???œë²ˆ ???œë„(?´ë°±)  if (!mm) {    const whole = normalizeEmailTokens(raw);    mm = whole.match(emailRe);  }  if (!mm) return { value: '', ok: false };  let id = mm[1].replace(/[\s.]/g, '');  // STTê°€ ì°ì? ??ê³µë°± ?œê±°  const provider = mm[2].toLowerCase();  const tld = mm[3].toLowerCase();  return { value: `${id.toLowerCase()}@${provider}.${tld}`, ok: true };}function sanitizeText(s: string) {  return s    // ë¬¸ì¥ ?´ë””?œë“  ?˜ì˜¤??ë¶ˆë¦¿/?€??+ ê³µë°± + (?°ì˜´???œê?/?ë¬¸) ?ì„ ?œê±°    // ?? ' - "???´ë¦„?€??, ' ??'?´ë¦„?€??, ' ?????´ë¦„?€??    .replace(/(?:^|\s)[??-?“â€?\s+(?=[""'A-Za-zê°€-??)/g, ' ')    // ?¨ì•„?ˆëŠ” ?¨ë… ë¶ˆë¦¿/?€?œë„ ?¼ê´„ ?•ë¦¬    .replace(/[??-?“â€?/g, ' ')    // ?????°ì˜´?œë¥˜    .replace(/[""'Â«Â»?Œã€ã€ã€?/g, ' ')    // ê´„í˜¸ë¥?    .replace(/[(){}\[\]<>]/g, ' ')    // ë§ˆì¹¨???ë‚Œ??ë¬¼ìŒ?œë? ë¬¸ì¥ ê²½ê³„ë¡??µì¼    .replace(/[!ï¼?ï¼?/g, '.')    // ê³µë°± ?•ë¦¬    .replace(/\s+/g, ' ')    .trim();}const NAME_TRIGGER = /(??s*)??´ë¦„\s*(?:?€|??:)?\s*/i;// STOP???°ì˜´??ê´„í˜¸/?€???¬í•¨// ê³µë°± ?œê±°: ?´ë¦„ ?¤ì˜ ê³µë°±?ì„œ ë©ˆì¶”ì§€ ?Šë„ë¡?const NAME_STOP = /(?=$|[\n.,!???"'()\[\]{}\-]|?…ë‹ˆ???´ì—???´ë¼ê³??¼êµ¬???¼ê³ )/i;function pickHangulName(seg: string, min=2, max=6) {  // ?œê? ê¸€???¬ì´ ê³µë°± ?œê±°: ????ë§????´ì¬ë§?  seg = seg.replace(/([ê°€-??)\s+(?=[ê°€-??)/g, '$1');  const tokens = seg.match(/[ê°€-??{2,6}/g) ?? [];  if (!tokens.length) return '';  // ê¸¸ì´ ?°ì„ (?™ì¼ ê¸¸ì´ë©??ì„  ê²?  tokens.sort((a,b) => b.length - a.length);  return tokens[0] ?? '';}function _testName(t: string){  const text = sanitizeText(t);  const TRIG = /(?:??s*)??´ë¦„\s*(?:?€|??:)?\s*/i;  // ???¬ê¸° ??ì¤„ë§Œ ?•í™•??êµì²´?˜ì„¸??  const STOP = /(?=$|[\n.,!???"'()\[\]{}\-]|?…ë‹ˆ???´ì—???´ë¼ê³??¼êµ¬???¼ê³ )/i;  const re = new RegExp(TRIG.source + '([\\s\\S]{0,30}?)' + STOP.source, 'i');  const m = text.match(re);  const seg = m ? m[1] : '';  const name = pickHangulName(seg, 2, 6).replace(/??/, '');  return { value: name, ok: !!name, text, seg };} // === export & dev-console hooks ===export function extractName(t: string) {  const result = _testName(t);  return result.ok ? result.value : null;}export function extractEmail(t: string) {  return _testEmail(t);}// ê°œë°œ ì¤?ì½˜ì†”?ì„œ ë°”ë¡œ ?ŒìŠ¤?¸í•  ???ˆë„ë¡??„ì—­ ???¸ì¶œdeclare global {  interface Window {    __testName?: (t: string) => { value: string; ok: boolean };    __testEmail?: (t: string) => { value: string; ok: boolean };  }}if (import.meta.env.DEV && typeof window !== 'undefined') {  window.__testName = extractName;  window.__testEmail = extractEmail;} 
