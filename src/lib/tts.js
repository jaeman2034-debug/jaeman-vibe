"use strict";
// TTS?� STT�??�호 배�?�?만들�?let isListening = false;       // STT ?�태let isSpeakingTTS = false;     // TTS ?�태export function speak(text: string) {  if (isListening) return;           // ???�는 중엔 ?��? TTS ?�생 금�?  if (isSpeakingTTS) return;         // ???��? 말하??중이�?중복 방�?    const u = new SpeechSynthesisUtterance(text);  isSpeakingTTS = true;  u.onend = () => (isSpeakingTTS = false);  u.onerror = () => (isSpeakingTTS = false);  // ?�러 ?�에???�태 복구    try { speechSynthesis.cancel(); } catch {}  speechSynthesis.speak(u);}export function startListeningGuard() {  try { speechSynthesis.cancel(); } catch {}   // ???�기 ?�작 ?�에 TTS 즉시 중단  isSpeakingTTS = false;                      // ??TTS ?�태 강제 리셋    // 모든 ?�디???�소 ?�리  const audio = document.getElementById("tts-audio") as HTMLAudioElement | null;  if (audio) { audio.pause(); audio.currentTime = 0; }    // 추�? ?�디???�소?�도 ?�리 (?�시 모�? 경우)  document.querySelectorAll('audio').forEach(a => {    a.pause();    a.currentTime = 0;  });    isListening = true;}export function stopListeningGuard() {  isListening = false;}// ?�태 ?�인 ?�수??export function isCurrentlyListening(): boolean {  return isListening;}export function isCurrentlySpeaking(): boolean {  return isSpeakingTTS;}// 강제 TTS 중단 (긴급 ?�황??export function forceStopTTS() {  try { speechSynthesis.cancel(); } catch {}  isSpeakingTTS = false;  const audio = document.getElementById("tts-audio") as HTMLAudioElement | null;  if (audio) { audio.pause(); audio.currentTime = 0; }}// ?��?�??�시 문장 ?�거 (보조 ?�전�?export function stripExamples(s: string): string {  // '??' ?�는 '?�시'가 ?�어�?문장/�??�거  return s    .split(/\n|[.?!]/)    .filter(line => {      const trimmed = line.trim();      // ??, ?�시, ??:, ???????�양???�턴 ?�거      return !/^(??:??|??s*:|?�시|??s*??/i.test(trimmed);    })    .join(". ")    .replace(/\s*\.\s*\./g, ".")  // ?�속?????�리    .trim();} 
