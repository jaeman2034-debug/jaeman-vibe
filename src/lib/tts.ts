// TTS?€ STTë¥??í˜¸ ë°°í?ë¡?ë§Œë“¤ê¸?let isListening = false;       // STT ?íƒœlet isSpeakingTTS = false;     // TTS ?íƒœexport function speak(text: string) {  if (isListening) return;           // ???£ëŠ” ì¤‘ì—” ?ˆë? TTS ?¬ìƒ ê¸ˆì?  if (isSpeakingTTS) return;         // ???´ë? ë§í•˜??ì¤‘ì´ë©?ì¤‘ë³µ ë°©ì?    const u = new SpeechSynthesisUtterance(text);  isSpeakingTTS = true;  u.onend = () => (isSpeakingTTS = false);  u.onerror = () => (isSpeakingTTS = false);  // ?ëŸ¬ ?œì—???íƒœ ë³µêµ¬    try { speechSynthesis.cancel(); } catch {}  speechSynthesis.speak(u);}export function startListeningGuard() {  try { speechSynthesis.cancel(); } catch {}   // ???£ê¸° ?œì‘ ?„ì— TTS ì¦‰ì‹œ ì¤‘ë‹¨  isSpeakingTTS = false;                      // ??TTS ?íƒœ ê°•ì œ ë¦¬ì…‹    // ëª¨ë“  ?¤ë””???”ì†Œ ?•ë¦¬  const audio = document.getElementById("tts-audio") as HTMLAudioElement | null;  if (audio) { audio.pause(); audio.currentTime = 0; }    // ì¶”ê? ?¤ë””???”ì†Œ?¤ë„ ?•ë¦¬ (?¹ì‹œ ëª¨ë? ê²½ìš°)  document.querySelectorAll('audio').forEach(a => {    a.pause();    a.currentTime = 0;  });    isListening = true;}export function stopListeningGuard() {  isListening = false;}// ?íƒœ ?•ì¸ ?¨ìˆ˜??export function isCurrentlyListening(): boolean {  return isListening;}export function isCurrentlySpeaking(): boolean {  return isSpeakingTTS;}// ê°•ì œ TTS ì¤‘ë‹¨ (ê¸´ê¸‰ ?í™©??export function forceStopTTS() {  try { speechSynthesis.cancel(); } catch {}  isSpeakingTTS = false;  const audio = document.getElementById("tts-audio") as HTMLAudioElement | null;  if (audio) { audio.pause(); audio.currentTime = 0; }}// ?„ì?ë§??ˆì‹œ ë¬¸ì¥ ?œê±° (ë³´ì¡° ?ˆì „ë§?export function stripExamples(s: string): string {  // '??' ?ëŠ” '?ˆì‹œ'ê°€ ?¤ì–´ê°?ë¬¸ì¥/ì¤??œê±°  return s    .split(/\n|[.?!]/)    .filter(line => {      const trimmed = line.trim();      // ??, ?ˆì‹œ, ??:, ???????¤ì–‘???¨í„´ ?œê±°      return !/^(??:??|??s*:|?ˆì‹œ|??s*??/i.test(trimmed);    })    .join(". ")    .replace(/\s*\.\s*\./g, ".")  // ?°ì†?????•ë¦¬    .trim();} 
