"use strict";
// upload.tsimport { storage, db } from "./firebase";import { ref, uploadBytesResumable, getDownloadURL } from "firebase/storage";import { addDoc, collection, serverTimestamp, doc, updateDoc } from "firebase/firestore";export async function uploadImage(file: File) {  const safe = file.name.replace(/[^\w.\-]+/g, "_");  const path = `market/${Date.now()}-${safe}`;  const snap = await uploadBytesResumable(ref(storage, path), file);  const url = await getDownloadURL(snap.ref);  return { url, path };}export async function createProduct(values: {  title: string;  price: number;  category: string;  description?: string;  loc?: { lat: number; lng: number };}, file?: File) {  const images = file ? [await uploadImage(file)] : [];  const docRef = await addDoc(collection(db, "products"), {    ...values,    images,    createdAt: serverTimestamp(),    addr: { hjdStatus: "pending" }    // ?�정??진행 ?�태 초기??  });  return docRef.id;}export async function attachImage(productId: string, file: File) {  const img = await uploadImage(file);  await updateDoc(doc(db, "products", productId), {    images: [img],    updatedAt: serverTimestamp(),  });  return img;}
