import { useState, useMemo } from 'react';import { useNavigate } from 'react-router-dom';import { createMarketItem } from '@/features/market/marketService';const CATEGORIES = ['ì¶•êµ¬??,'? ë‹ˆ??,'ë³´í˜¸?€','ë³?,'?˜ë¥˜','?¼êµ¬','?êµ¬','?Œë‹ˆ??,'ê³¨í”„','ê¸°í?'];const box: React.CSSProperties = { maxWidth: 720, margin: '24px auto', padding: 16 };const label: React.CSSProperties = { fontSize: 13, color: '#555', marginTop: 10 };const row: React.CSSProperties = { display: 'flex', gap: 8, alignItems: 'center', flexWrap: 'wrap' };export default function MarketNew() {  const nav = useNavigate();  const [title, setTitle] = useState('');  const [category, setCategory] = useState(CATEGORIES[0]);  const [condition, setCondition] = useState<'?ˆìƒ?? | 'ìµœìƒ' | '?? | 'ì¤? | '??>('?ˆìƒ??);  const [priceText, setPriceText] = useState('');  const price = useMemo(() => Number(priceText.replace(/[^\d]/g, '')) || 0, [priceText]);  const [desc, setDesc] = useState('');  const [files, setFiles] = useState<File[]>([]);  const [busy, setBusy] = useState(false);  const [err, setErr] = useState('');  function onPick(e: React.ChangeEvent<HTMLInputElement>) {    const list = e.target.files ? Array.from(e.target.files) : [];    if (!list.length) return;    const merged = [...files, ...list].slice(0, 10);    setFiles(merged);    e.target.value = '';  }  function removeAt(i: number) { setFiles(prev => prev.filter((_, idx) => idx !== i)); }  function validate(): string | null {    if (!title.trim()) return '?œëª©???…ë ¥??ì£¼ì„¸??';    if (price <= 0) return 'ê°€ê²©ì„ ?…ë ¥??ì£¼ì„¸??';    if (!files.length) return '?´ë?ì§€ë¥??????´ìƒ ì²¨ë???ì£¼ì„¸??';    return null;  }  async function onSubmit(e: React.FormEvent) {    e.preventDefault(); setErr('');    const v = validate(); if (v) { setErr(v); return; }    try {      setBusy(true);      // ??images ?„ë“œ??File ë°°ì—´??ì§ì ‘ ?„ë‹¬ (createMarketItem?ì„œ URLë¡?ë³€??      await createMarketItem({         title,         category,         condition,         price,         description: desc,         images: files       });      alert('?±ë¡?˜ì—ˆ?µë‹ˆ??');      nav('/market');    } catch (e: any) {      setErr(e?.message || '?±ë¡ ì¤??¤ë¥˜ê°€ ë°œìƒ?ˆìŠµ?ˆë‹¤.');    } finally { setBusy(false); }  }  return (    <div style={box}>      <h2>?í’ˆ ?±ë¡</h2>      <form onSubmit={onSubmit} style={{ display: 'grid', gap: 8 }}>        <div style={label}>?¬ì§„ (ìµœë? 10??</div>        <div style={{ border: '1px dashed #bbb', borderRadius: 10, padding: 12, display:'flex', gap:10, flexWrap:'wrap', alignItems:'center' }}>          <label style={{ border:'1px solid #ddd', borderRadius:8, padding:'8px 12px', background:'#f8f8f8', cursor:'pointer' }}>            + ?´ë?ì§€ ì¶”ê?            <input type="file" accept="image/*" multiple hidden onChange={onPick}/>          </label>          {files.map((f, i) => (            <div key={i} style={{ position:'relative' }}>              <img src={URL.createObjectURL(f)} alt="" width={96} height={96}                   style={{objectFit:'cover', borderRadius:8, border:'1px solid #eee'}} />              <button type="button" onClick={()=>removeAt(i)}                style={{ position:'absolute', right:-8, top:-8, background:'#fff', border:'1px solid #ddd', borderRadius:999, width:22, height:22, cursor:'pointer' }}>                Ã—              </button>            </div>          ))}        </div>        <div style={label}>?œëª©</div>        <input value={title} onChange={e=>setTitle(e.target.value)} placeholder="?? ?˜ì´???¬í? GX 275mm" />        <div style={label}>ì¹´í…Œê³ ë¦¬ / ?íƒœ</div>        <div style={row}>          <select value={category} onChange={e=>setCategory(e.target.value)}>            {CATEGORIES.map(c => <option key={c} value={c}>{c}</option>)}          </select>          <select value={condition} onChange={e=>setCondition(e.target.value as any)}>            <option value="?ˆìƒ??>?ˆìƒ??/option>            <option value="ìµœìƒ">ìµœìƒ</option>            <option value="??>??/option>            <option value="ì¤?>ì¤?/option>            <option value="??>??/option>          </select>        </div>        <div style={label}>ê°€ê²???</div>        <input          inputMode="numeric"          value={priceText}          onChange={e=>{            const raw = e.target.value.replace(/[^\d]/g, '');            const withComma = raw.replace(/\B(?=(\d{3})+(?!\d))/g, ',');            setPriceText(withComma);          }}          placeholder="?? 35,000"        />        <div style={label}>?¤ëª…</div>        <textarea rows={5} value={desc} onChange={e=>setDesc(e.target.value)}                  placeholder="?ì„¸ ?íƒœ, ?¬ì´ì¦? ê±°ë˜ ?¬ë§ ?„ì¹˜ ?±ì„ ?…ë ¥??ì£¼ì„¸??"/>        {err && <div style={{ color: 'crimson' }}>{err}</div>}        <button disabled={busy} type="submit" style={{ padding:'10px 14px', borderRadius:8 }}>          {busy ? '?±ë¡ ì¤‘â€? : '?±ë¡?˜ê¸°'}        </button>      </form>      <p style={{fontSize:12, color:'#777', marginTop:8}}>        * ?…ë¡œ????ë¡œê·¸?¸ëœ ê³„ì •?¼ë¡œ Firestore/Storage???€?¥ë©?ˆë‹¤.      </p>    </div>  );} 