import type { NextApiRequest, NextApiResponse } from "next";const allow = (process.env.ALLOWED_ORIGINS || "")  .split(",").map(s => s.trim()).filter(Boolean);function setCORS(req: NextApiRequest, res: NextApiResponse) {  const origin = req.headers.origin || "";  const ok = allow.length ? allow.includes(origin) : true;  res.setHeader("Access-Control-Allow-Origin", ok ? origin : "null");  res.setHeader("Vary", "Origin");  res.setHeader("Access-Control-Allow-Credentials", "true");  res.setHeader("Access-Control-Allow-Methods", "POST, OPTIONS");  res.setHeader("Access-Control-Allow-Headers", "Content-Type, Authorization");}export default async function handler(req: NextApiRequest, res: NextApiResponse) {  setCORS(req, res);  if (req.method === "OPTIONS") return res.status(204).end();  if (req.method !== "POST") return res.status(405).end();  try {    // TODO: ?€??    // console.log("telemetry", (req.body?.events ?? []).length);    res.status(200).json({ ok: true });  } catch {    res.status(400).json({ ok: false });  }} 
