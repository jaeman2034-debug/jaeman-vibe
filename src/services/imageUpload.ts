import { ref, uploadBytes, getDownloadURL } from 'firebase/storage';import { storage } from '@/lib/firebase';const isDataUri = (s: string) => /^data:image\/(png|jpe?g|webp|gif);base64,/i.test(s);export async function uploadDataUriToStorage(dataUri: string, path: string) {  const blob = await (await fetch(dataUri)).blob();  const storageRef = ref(storage, path);  await uploadBytes(storageRef, blob, { contentType: blob.type });  return await getDownloadURL(storageRef);}/** ?í’ˆ ?€?????´ë?ì§€ ?•ê·œ?? Data URI ???…ë¡œ?? ?„ë‹ˆë©?ê·¸ë?ë¡?*/export async function normalizeImagesBeforeSave(productId: string, images: string[]) {  const out: string[] = [];  for (let i = 0; i < images.length; i++) {    const img = images[i];    if (isDataUri(img)) {      const url = await uploadDataUriToStorage(        img,        `markets/${productId}/${Date.now()}_${i}.webp`      );      out.push(url); // ?ëŠ” ê²½ë¡œë§??€?¥í•˜ê³??¶ë‹¤ë©?storageRef.fullPathë¥??€??    } else {      out.push(img);    }  }  return out;}
