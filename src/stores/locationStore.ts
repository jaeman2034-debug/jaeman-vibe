// src/stores/locationStore.tsimport { create } from 'zustand';import { getCurrentLocation } from '@/lib/locationService';type UserLocation = { lat: number; lng: number; accuracy?: number; timestamp: number } | null;export const useLocationStore = create<{  userLoc: UserLocation;  setUserLoc: (l: UserLocation) => void;  load: () => void;  clear: () => void;  fetchCurrent: () => Promise<void>;  isLoading: boolean;  error: string | null;}>(set => ({  userLoc: null,  isLoading: false,  error: null,    setUserLoc: (l) => {     if (l) {      localStorage.setItem('userLoc', JSON.stringify(l));     } else {      localStorage.removeItem('userLoc');    }    set({ userLoc: l, error: null });   },    load: () => {     try {      const raw = localStorage.getItem('userLoc');      if (raw) {        const parsed = JSON.parse(raw);        // 24?œê°„ ?´ë‚´???„ì¹˜ ?•ë³´ë§?? íš¨        const oneDay = 24 * 60 * 60 * 1000;        if (Date.now() - parsed.timestamp < oneDay) {          set({ userLoc: parsed });          return;        }      }      // ? íš¨?˜ì? ?Šìœ¼ë©??œê±°      localStorage.removeItem('userLoc');      set({ userLoc: null });    } catch (error) {      console.error('?„ì¹˜ ?•ë³´ ë¡œë“œ ?¤íŒ¨:', error);      localStorage.removeItem('userLoc');      set({ userLoc: null });    }  },    clear: () => {    localStorage.removeItem('userLoc');    set({ userLoc: null, error: null });  },    fetchCurrent: async () => {    set({ isLoading: true, error: null });        try {      const location = await getCurrentLocation();      const userLocation: UserLocation = {        lat: location.lat,        lng: location.lng,        accuracy: location.accuracy,        timestamp: Date.now()      };            // localStorage???€?¥í•˜ê³??íƒœ ?…ë°?´íŠ¸      localStorage.setItem('userLoc', JSON.stringify(userLocation));      set({ userLoc: userLocation, isLoading: false });    } catch (error) {      const errorMessage = error instanceof Error ? error.message : '?„ì¹˜ë¥?ê°€?¸ì˜¬ ???†ìŠµ?ˆë‹¤.';      set({ error: errorMessage, isLoading: false });    }  }}));// ?„ì¹˜ ?•ë³´ê°€ ? íš¨?œì? ?•ì¸?˜ëŠ” ?¬í¼ ?¨ìˆ˜export const isLocationValid = (location: UserLocation): boolean => {  if (!location) return false;    // 24?œê°„ ?´ë‚´???„ì¹˜ ?•ë³´ë§?? íš¨  const oneDay = 24 * 60 * 60 * 1000;  if (Date.now() - location.timestamp > oneDay) return false;    // ì¢Œí‘œ ? íš¨??ê²€??  return (    location.lat >= -90 && location.lat <= 90 &&    location.lng >= -180 && location.lng <= 180  );};// ê¸°ì¡´ ?…ê³¼???¸í™˜?±ì„ ?„í•œ ë³„ì¹­export const useUserLocation = useLocationStore; 
