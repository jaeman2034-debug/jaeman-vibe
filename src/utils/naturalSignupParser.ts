// ==== Natural Signup Parser (drop-in) ====// ?«ì ?œêµ­?????«ìconst DIGIT_KO: Record<string, string> = {  "??:"0","ê³?:"0","ë¹?:"0",  "??:"1","??:"2","??:"2","??:"3","??:"4","??:"5","??:"6","ë¥?:"6","ì¹?:"7","??:"8","êµ?:"9",};const DIGIT_TOKENS = Object.keys(DIGIT_KO).sort((a,b)=>b.length-a.length);// ?ŒíŒŒë²??œêµ­???¤í ë§?ê°„ë‹¨ ë²„ì „)const ALPHA_KO: Record<string, string> = {  "?ì´":"a","ë¹?:"b","??:"c","??:"d","??:"e","?í”„":"f","ì§€":"g","?ì´ì¹?:"h","?„ì´":"i",  "?œì´":"j","ì¼€??:"k","??:"l","??:"m","??:"n","??:"o","??:"p","??:"q","?„ë¥´":"r",  "?ìŠ¤":"s","??:"t","??:"u","ë¸Œì´":"v","?”ë¸”??:"w","?‘ìŠ¤":"x","?€??:"y","?œíŠ¸":"z","ì§€??:"z",};// ?´ë©”???œê³µ??ìµœìƒ?„ë„ë©”ì¸ ?œê? ???ë¬¸const PROVIDER_KO: Record<string,string> = {  "ì§€ë©”ì¼":"gmail","gë©”ì¼":"gmail","g ë©”ì¼":"gmail","gmail":"gmail",  "?¤ì´ë²?:"naver","?¤ìŒ":"daum","?œë©”??:"hanmail","ì¹´ì¹´??:"kakao","ì¹´ì¹´?¤ë©”??:"kakao",};const TLD_KO: Record<string,string> = {  "ì»?:"com","ì½?:"com","ì»´ë§ˆ":"com","ì»´í“¨??:"com","??:"net","?¤íŠ¸":"net",};// êµ¬ë‘????ê¸°í˜¸const SYM_RULES: Array<[RegExp,string]> = [  [/(ê³¨ë±…????\bat\b)/g, " @ "],  [/(????ì©?/g, " . "],];// ê³µë°± ?•ë¦¬const squish = (s:string) => s.replace(/\s+/g," ").trim();// ?œêµ­???«ì/?ŒíŒŒ ?¤í ë§ì„ ???«ìë¡?ë°”ê¾¸??ê°€ë²¼ìš´ ?•ê·œ??function koTokensToAscii(s: string) {  let out = s;  // ?¬ë³¼ ì¹˜í™˜  for (const [re,rep] of SYM_RULES) out = out.replace(re, rep);  // ? í° ?¨ìœ„ ì¹˜í™˜  out = out.split(/\s+/).map(t=>{    if (ALPHA_KO[t]) return ALPHA_KO[t];    if (DIGIT_KO[t]) return DIGIT_KO[t];    return t;  }).join(" ");  return out;}// ?„í™” ì¶”ì¶œ: 01xë¡??œì‘?˜ëŠ” 10~11?ë¦¬ ?°ì„ function extractPhone(raw: string): string {  // ?œêµ­???«ì ?¨ì–´ë¥??«ìë¡?ë°”ê¾¼ ??ëª¨ë‘ ?«ìë§??¨ê?  const ko = raw.replace(new RegExp(DIGIT_TOKENS.join("|"),"g"), (m)=>DIGIT_KO[m] ?? m);  const onlyDigits = ko.replace(/[^\d]/g,"");  // ?„ë³´: 010 ~ 019 ë¡??œì‘, 10~11?ë¦¬  const candidates: string[] = [];  for (let i=0;i<onlyDigits.length-9;i++){    for (let len of [11,10]){      const sub = onlyDigits.slice(i,i+len);      if (/^01\d/.test(sub) && (len===10 || len===11)) candidates.push(sub);    }  }  // ê°€???ì—???¡íŒ ê±??°ì„  ë°˜í™˜  const picked = candidates[0] || "";  return picked ? picked.replace(/(\d{3})(\d{3,4})(\d{4})/, "$1-$2-$3") : "";}// ?´ë©”??ì¶”ì¶œ(ê´€?©ì–´ ?ˆìš©: "?„ì´??ê³¨ë±…??ì§€ë©”ì¼ ??ì»? / "id gmail com" ??function extractEmail(rawInput: string): string {  let s = rawInput.toLowerCase();  s = koTokensToAscii(s);  s = squish(s);  // ?œê³µ???„ë©”???œê? ???ë¬¸  Object.entries(PROVIDER_KO).forEach(([k,v])=>{    s = s.replace(new RegExp(`\\b${k}\\b`, "g"), ` ${v} `);  });  Object.entries(TLD_KO).forEach(([k,v])=>{    s = s.replace(new RegExp(`\\b${k}\\b`, "g"), ` ${v} `);  });  // ?”í•œ ?¤ì¸???¡ì†Œ ?œê±°  s = s.replace(/\b(ì²˜ëŸ¼|ê·¸ë¦¬ê³??…ë‹ˆ???´ì—???´ë©”?¼ì?|?´ë©”?¼ì????´ë©”?¼ì´|ë©”ì¼?€|ì£¼ì†Œ???´ë¦„?€|?„í™”ë²ˆí˜¸??ë²ˆí˜¸??\b/g, " ");  s = squish(s);  // 1) ?´ë? ?„ì„±???´ë©”?¼ì´ ?ˆìœ¼ë©?ê·¸ë?ë¡??¬ìš©  const emailRe = /([a-z0-9._%+-]{1,64})@([a-z0-9-]{1,63})\.([a-z.]{2,10})/i;  const m = s.match(emailRe);  if (m) return `${m[1]}@${m[2]}.${m[3]}`;  // 2) ? í°??ë³´ë©´??i d / @ / provider / tld ì¡°í•© ?¬êµ¬??  const tokens = s.split(/\s+/);  let id = "", hasAt = false, domLeft = "", tld = "";  for (let i=0;i<tokens.length;i++){    const tk = tokens[i];    if (tk === "@") { hasAt = true; continue; }    if (tk === ".") { /* skip lone dots */ continue; }    // provider ?ëŠ” tld    if (["gmail","naver","daum","hanmail","kakao"].includes(tk)) {      domLeft = tk; continue;    }    if (["com","net","co.kr","kr"].includes(tk)) { tld = tk; continue; }    // ?ŒíŒŒ?˜ë§Œ id???„ì     if (/^[a-z0-9._-]+$/.test(tk)) {      if (!hasAt) id += tk;      else if (!domLeft) domLeft = tk; // '@' ?´í›„?¼ë©´ ?„ë©”???¼ìª½      else if (!tld) tld = tk;         // ?¹ì‹œ 'gmail com' ê°™ì´ ?°ì†    }  }  // ?„ì  ì¡°í•©  if (id && (hasAt || domLeft)) {    const dom = domLeft ? `${domLeft}.${tld || "com"}` : "";    const email = `${id}@${dom}`.replace(/\.+/g,".").replace(/@\./,"@");    if (/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email)) return email;  }  return ""; // ëª?ì°¾ìœ¼ë©?ë¹?ê°?}// ?´ë¦„ ì¶”ì¶œ(ê°€??ê¸?'?œê?ë§? 2~6??êµ¬ê°„)function extractName(raw: string): string {  const hangulChunks = raw.replace(/[^ê°€-??s]/g," ").split(/\s+/).filter(Boolean);  // ?˜ë? ?ˆì–´ ë³´ì´??2~6?? ?„ë³´ ì¤?ê°€??ê¸?ê²ƒì„ ? íƒ  const cands = hangulChunks.filter(w => w.length >= 2 && w.length <= 6);  // "???´ë¦„?€ ?? ?¨í„´ ?°ì„   const m = raw.match(/(??s*?´ë¦„?€|?€??\s*([ê°€-??{2,6})/);  if (m) return m[2];  if (cands.length) return cands.sort((a,b)=>b.length-a.length)[0];  return "";}// ë¹„ë?ë²ˆí˜¸ ì¶”ì¶œ("ë¹„ë?ë²ˆí˜¸???? ?¤ìª½ ?ŒíŒŒ??ê¸°í˜¸ 8+ ?°ì„ )function extractPassword(raw:string): string {  const after = raw.split(/ë¹„ë?ë²ˆí˜¸(???”ìš”)?/)[2] || "";  if (after) {    const t = koTokensToAscii(after.toLowerCase()).replace(/\s+/g,"");    const m = t.match(/[a-z0-9!@#$%^&*()_+\-=\[\]{};':",.<>/?]{8,}/i);    if (m) return m[0].slice(0,32); // ?ˆì „?˜ê²Œ 32???œí•œ  }  // ëª?ì°¾ìœ¼ë©?ë¹„ì›Œ??  return "";}export function parseNaturalSignup(raw: string) {  const text = squish(raw || "");  const name  = extractName(text);  const email = extractEmail(text);  const phone = extractPhone(text);  const password = extractPassword(text);  return { name, email, phone, password };} 