"use strict";
// ?�능 최적???�틸리티// ?��?지 지??로딩???�한 Intersection Observerexport const createImageObserver = (  callback: (entry: IntersectionObserverEntry) => void,  options: IntersectionObserverInit = {}) => {  const defaultOptions: IntersectionObserverInit = {    root: null,    rootMargin: '50px',    threshold: 0.1,    ...options  };  return new IntersectionObserver((entries) => {    entries.forEach(callback);  }, defaultOptions);};// ?�바?�스 ?�수export const debounce = <T extends (...args: any[]) => any>(  func: T,  wait: number): ((...args: Parameters<T>) => void) => {  let timeout: NodeJS.Timeout;    return (...args: Parameters<T>) => {    clearTimeout(timeout);    timeout = setTimeout(() => func(...args), wait);  };};// ?�로?� ?�수export const throttle = <T extends (...args: any[]) => any>(  func: T,  limit: number): ((...args: Parameters<T>) => void) => {  let inThrottle: boolean;    return (...args: Parameters<T>) => {    if (!inThrottle) {      func(...args);      inThrottle = true;      setTimeout(() => inThrottle = false, limit);    }  };};// ?��?지 최적???�수export const optimizeImage = async (  file: File,  options: {    maxWidth?: number;    maxHeight?: number;    quality?: number;    format?: 'webp' | 'avif' | 'jpeg' | 'png';  } = {}): Promise<File> => {  const {    maxWidth = 1600,    maxHeight = 1600,    quality = 0.8,    format = 'webp'  } = options;  return new Promise((resolve, reject) => {    const canvas = document.createElement('canvas');    const ctx = canvas.getContext('2d');    const img = new Image();    img.onload = () => {      // 캔버???�기 계산      const { width, height } = calculateDimensions(        img.width,        img.height,        maxWidth,        maxHeight      );      canvas.width = width;      canvas.height = height;      // ?��?지 그리�?      ctx?.drawImage(img, 0, 0, width, height);      // ?�맷�??�질 ?�정      let mimeType: string;      let qualityValue: number;      switch (format) {        case 'webp':          mimeType = 'image/webp';          qualityValue = quality;          break;        case 'avif':          mimeType = 'image/avif';          qualityValue = quality;          break;        case 'jpeg':          mimeType = 'image/jpeg';          qualityValue = quality;          break;        case 'png':          mimeType = 'image/png';          qualityValue = 1;          break;        default:          mimeType = 'image/webp';          qualityValue = quality;      }      // 캔버?��? Blob?�로 변??      canvas.toBlob(        (blob) => {          if (blob) {            const optimizedFile = new File([blob], file.name, {              type: mimeType,              lastModified: Date.now()            });            resolve(optimizedFile);          } else {            reject(new Error('?��?지 최적???�패'));          }        },        mimeType,        qualityValue      );    };    img.onerror = () => reject(new Error('?��?지 로드 ?�패'));    img.src = URL.createObjectURL(file);  });};// ?��?지 ?�기 계산const calculateDimensions = (  originalWidth: number,  originalHeight: number,  maxWidth: number,  maxHeight: number) => {  let { width, height } = { width: originalWidth, height: originalHeight };  if (width > maxWidth) {    height = (height * maxWidth) / width;    width = maxWidth;  }  if (height > maxHeight) {    width = (width * maxHeight) / height;    height = maxHeight;  }  return { width: Math.round(width), height: Math.round(height) };};// 메모�??�용??모니?�링export const monitorMemoryUsage = () => {  if ('memory' in performance) {    const memory = (performance as any).memory;    const used = Math.round(memory.usedJSHeapSize / 1048576);    const total = Math.round(memory.totalJSHeapSize / 1048576);    const limit = Math.round(memory.jsHeapSizeLimit / 1048576);        console.log(`메모�??�용?? ${used}MB / ${total}MB (?�한: ${limit}MB)`);        // 메모�??�용?�이 80%�??�으�?경고    if (used / limit > 0.8) {      console.warn('메모�??�용?�이 ?�습?�다. ?��?지 캐시�??�리?�세??');    }  }};// ?��?지 캐시 ?�리export const clearImageCache = () => {  // URL.createObjectURL�??�성??객체???�리  if ('revokeObjectURL' in URL) {    // ?�제로는 �??��?지 URL??추적?�서 ?�리?�야 ??    console.log('?��?지 캐시 ?�리 ?�료');  }}; 
